<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta property="wb:webmaster" content="65a151beb5e21880" />
	<!-- baidu analytics-->
	<script>
		var _hmt = _hmt || [];
		(function() {
			var hm = document.createElement("script");
			hm.src = "https://hm.baidu.com/hm.js?09df6a0c610161ab3099d8e11e9c998e";
			var s = document.getElementsByTagName("script")[0];
			s.parentNode.insertBefore(hm, s);
		})();
	</script>
	<!-- google analytics-->
	<script>
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
		ga('create', 'UA-86667923-1', 'auto');
		ga('send', 'pageview');
	</script>
	
	<title>Gulp 快速入门 | Bevis Blog - 沈浩个人博客</title>
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<meta name="description" content="现今，gulp 在前端工程化开发中的重要程度可见一斑，好多重复繁琐的操作 gulp 都可以帮助完成，不像以前的手动去操作，简直是前端开发人员的福音，之前学习 gulp 时没有整理出清晰的学习笔记，这次特地把之前零零散散的笔记整理一份出来。">
<meta property="og:type" content="article">
<meta property="og:title" content="Gulp 快速入门">
<meta property="og:url" content="https://utopia1991.github.io/2017/01/03/gulp/index.html">
<meta property="og:site_name" content="Bevis Blog - 沈浩个人博客">
<meta property="og:description" content="现今，gulp 在前端工程化开发中的重要程度可见一斑，好多重复繁琐的操作 gulp 都可以帮助完成，不像以前的手动去操作，简直是前端开发人员的福音，之前学习 gulp 时没有整理出清晰的学习笔记，这次特地把之前零零散散的笔记整理一份出来。">
<meta property="og:image" content="https://utopia1991.github.io/images/gulp/1.png">
<meta property="og:image" content="https://utopia1991.github.io/images/gulp/2.png">
<meta property="og:image" content="https://utopia1991.github.io/images/gulp/3.png">
<meta property="og:updated_time" content="2017-01-03T06:28:56.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Gulp 快速入门">
<meta name="twitter:description" content="现今，gulp 在前端工程化开发中的重要程度可见一斑，好多重复繁琐的操作 gulp 都可以帮助完成，不像以前的手动去操作，简直是前端开发人员的福音，之前学习 gulp 时没有整理出清晰的学习笔记，这次特地把之前零零散散的笔记整理一份出来。">
<meta name="twitter:image" content="https://utopia1991.github.io/images/gulp/1.png">
	
	
		<link rel="icon" href="https://utopia1991.github.io/css/images/icon.png">
	
	
		<link href="https://fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
	
	<link rel="stylesheet" href="/css/style.css">
	

	<script src="//cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script>
</head>

<body>
	<a href="https://github.com/utopia1991" target="_blank" class="githubFork">
		<img src="https://camo.githubusercontent.com/e7bbb0521b397edbd5fe43e7f760759336b5e05f/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f677265656e5f3030373230302e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_green_007200.png">
	</a>
	<a class="backTop" onclick="backTop()">Top</a>
	<div id="container">
		<div id="wrap">
			<header id="header">
	<div id="header-outer" class="outer">
		<div id="header-title" class="inner">
			<h1 id="logo-wrap">
				<a href="/" id="logo">
					<span class="brand-logo">Bevis</span>
					Blog
				</a>
			</h1>
		</div>
		<div id="header-inner" class="inner">
			<nav id="main-nav">
				<a id="main-nav-toggle" class="nav-icon"></a>
				
					<a class="main-nav-link" href="/">主页</a>
				
					<a class="main-nav-link" href="/archives">博文</a>
				
				<a class="main-nav-link" href="https://utopia1991.github.io/p/about/index.html">关于我</a>
			</nav>
		</div>
	</div>
</header>

			<canvas width="100%" height="100%" id="canvas"></canvas>
			<div class="outer">
				
				<aside id="sidebar">
	<div class="aside-author">
		<a class="aside-logo" href="https://utopia1991.github.io/p/lover/index.html" target="_blank"></a>
		<p class="aside-title">Bevis Shen（沈浩）</p>
		<p class="aside-subtitle">Node.js & Front-End Engineer</p>
		<p class="aside-description">Google 重度粉，Mac 拥趸，前端 + Node 青年，对前沿技术有着狂热的激情，梦想环游世界，热爱生活、摄影、旅游、电影的文艺程序猿一枚</p>
		<div class="aside-communicate">
			<a href="https://github.com/utopia1991" target="_blank" class="article-share-github" title="github"></a>
			<a href="https://www.linkedin.com/in/bevis1991" target="_blank" class="article-share-linkedin" title="linkedin"></a>
			<a href="mailto:1304354608@qq.com" class="article-share-mail" title="email"></a>
			<a href="https://weibo.com/u/2619492527/home" target="_blank" class="article-share-weibo" title="weibo"></a>
			<a class="article-share-weixin" title="我的个人微信公众号"></a>
			<img src="https://utopia1991.github.io/css/images/wechat.png" width="180" height="180" class="wechat-pic">
			<a href="https://bevis1991.wordpress.com/" target="_blank" class="article-share-wordpress" title="WordPress 博客"></a>
			<a href="https://www.facebook.com/bevis1991" target="_blank" class="article-share-facebook" title="facebook"></a>
			<a href="https://twitter.com/bevis_shen" target="_blank" class="article-share-twitter" title="twitter"></a>
		</div>
	</div>
	
		

	
		
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/CSS/">CSS</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Code-Style/">Code Style</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Coffeescript/">Coffeescript</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Google/">Google</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Gulp/">Gulp</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HTML/">HTML</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HTTP/">HTTP</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Interview-Questions/">Interview-Questions</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Javascript/">Javascript</a><span class="tag-list-count">14</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Mac/">Mac</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Markdown/">Markdown</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MongoDB/">MongoDB</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/UnderscoreJS/">UnderscoreJS</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jQuery/">jQuery</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nodeJs/">nodeJs</a><span class="tag-list-count">1</span></li></ul>
    </div>
  </div>


	
		
  <div class="widget-wrap">
    <h3 class="widget-title">Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/CSS/" style="font-size: 10px;">CSS</a> <a href="/tags/Code-Style/" style="font-size: 17.5px;">Code Style</a> <a href="/tags/Coffeescript/" style="font-size: 10px;">Coffeescript</a> <a href="/tags/Google/" style="font-size: 10px;">Google</a> <a href="/tags/Gulp/" style="font-size: 10px;">Gulp</a> <a href="/tags/HTML/" style="font-size: 10px;">HTML</a> <a href="/tags/HTTP/" style="font-size: 10px;">HTTP</a> <a href="/tags/Interview-Questions/" style="font-size: 15px;">Interview-Questions</a> <a href="/tags/Javascript/" style="font-size: 20px;">Javascript</a> <a href="/tags/Mac/" style="font-size: 12.5px;">Mac</a> <a href="/tags/Markdown/" style="font-size: 10px;">Markdown</a> <a href="/tags/MongoDB/" style="font-size: 12.5px;">MongoDB</a> <a href="/tags/UnderscoreJS/" style="font-size: 12.5px;">UnderscoreJS</a> <a href="/tags/jQuery/" style="font-size: 10px;">jQuery</a> <a href="/tags/nodeJs/" style="font-size: 10px;">nodeJs</a>
    </div>
  </div>

	
		
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">三月 2017</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">二月 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">一月 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/12/">十二月 2016</a><span class="archive-list-count">12</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">十一月 2016</a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/10/">十月 2016</a><span class="archive-list-count">11</span></li></ul>
    </div>
  </div>


	
		
	<div class="widget-wrap">
		<h3 class="widget-title">最新文章</h3>
		<div class="widget">
			<ul>
				
					<li>
						<a href="/2017/03/23/learnSource/">
							做为优秀前端的必备学习资料
						</a>
					</li>
					
					<li>
						<a href="/2017/03/10/source/">
							超全 web 开发工具和资源
						</a>
					</li>
					
					<li>
						<a href="/2017/02/15/jsBug/">
							Javascript 设计缺陷
						</a>
					</li>
					
					<li>
						<a href="/2017/01/03/gulp/">
							Gulp 快速入门
						</a>
					</li>
					
					<li>
						<a href="/2016/12/27/feTired/">
							前端疲劳
						</a>
					</li>
					
					<li>
						<a href="/2016/12/27/reduceCoupling/">
							减少前端代码耦合
						</a>
					</li>
					
					<li>
						<a href="/2016/12/21/codeStyle4/">
							前端编码规范 4 —— CSS 和 SASS 规范
						</a>
					</li>
					
					<li>
						<a href="/2016/12/21/codeStyle3/">
							前端编码规范 3 —— JavaScript 规范
						</a>
					</li>
					
					<li>
						<a href="/2016/12/21/codeStyle2/">
							前端编码规范 2 —— HTML 规范
						</a>
					</li>
					
					<li>
						<a href="/2016/12/21/codeStyle1/">
							前端编码规范 1 —— 一般规范
						</a>
					</li>
					
					<li>
						<a href="/2016/12/16/underscore2/">
							UnderscoreJS 常用方法
						</a>
					</li>
					
					<li>
						<a href="/2016/12/15/interview3/">
							JavaScript 单线程机制面试题
						</a>
					</li>
					
					<li>
						<a href="/2016/12/14/vue/">
							Vue 基础学习笔记
						</a>
					</li>
					
					<li>
						<a href="/2016/12/13/mongodb/">
							MongoDB 操作基础语法（shell）
						</a>
					</li>
					
					<li>
						<a href="/2016/12/13/eventLoop/">
							JavaScript 运行机制
						</a>
					</li>
					
					<li>
						<a href="/2016/12/12/deferred/">
							jQuery $.deferred()对象
						</a>
					</li>
					
					<li>
						<a href="/2016/11/25/nodemailer/">
							使用 nodeJs 发送邮件
						</a>
					</li>
					
					<li>
						<a href="/2016/11/25/google/">
							教你使用 Google
						</a>
					</li>
					
					<li>
						<a href="/2016/11/23/interview2/">
							20个JS变态面试题解析
						</a>
					</li>
					
					<li>
						<a href="/2016/11/23/bem/">
							BEM - CSS命名规则
						</a>
					</li>
					
				......
			</ul>
		</div>
	</div>
	

	
</aside>

				
				<section id="main">
					<div class="main-header">
						<p class="header-title">Any application that can be written in JavaScript, will eventually be written in JavaScript.</p>
						<canvas id="bubbleCanvas" width="100%" height="300" style="margin-top:50px;"></canvas>
						<script>
							(function(){
								var width, height, canvas, ctx, circles;
								function initHeader() {
									try{
										canvas = document.getElementById('bubbleCanvas');
										if($("#bubbleCanvas").length>0){
											width = window.innerWidth*0.25>300?window.innerWidth*0.25:300;
											//height = window.innerHeight;
											height = 255;
											canvas.width = width;
											canvas.height = height;
											ctx = canvas.getContext('2d');
											circles = [];
											for(var x = 0; x < width*0.5; x++) {
												var c = new Circle();
												circles.push(c);
											}
											animate();
										}
									} catch(ex) {
										if(window.cosole&&window.cosole.log){cosole.log(ex)}
									}
								}
								function addListeners() {
									try{
										if($("#bubbleCanvas").length>0){
											window.addEventListener('resize', resize);
										}
									}catch(ex){if(window.cosole&&window.cosole.log){cosole.log(ex)}}
								}
								function resize() {
									width = window.innerWidth*0.25>300?window.innerWidth*0.25:300;
									height = window.innerHeight;
									canvas.width = width;
									canvas.height = height;
								}
								function animate() {
									ctx.clearRect(0,0,width,height);
									for(var i in circles) {
										circles[i].draw();
									}
									window.requestAFrame = (function () {
										return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||
											function (callback) {
												return window.setTimeout(callback, 1000 / 60); // shoot for 60 fps
											};
									})();
									requestAFrame(animate);
								}
								// Canvas manipulation
								function Circle() {
									var _this = this;
									// constructor
									(function() {
										_this.pos = {};
										init();
									})();

									function init() {
										_this.pos.x = Math.random()*width;
										_this.pos.y = height+Math.random()*100;
										_this.alpha = 0.1+Math.random()*0.3;
										_this.scale = 0.1+Math.random()*0.3;
										_this.velocity = Math.random();
									}

									this.draw = function() {
										if(_this.alpha <= 0) {
											init();
										}
										_this.pos.y -= _this.velocity;
										_this.alpha -= 0.0005;
										ctx.beginPath();
										ctx.arc(_this.pos.x, _this.pos.y, _this.scale*10, 0, 2 * Math.PI, false);
										ctx.fillStyle = 'rgba(255,255,255,'+ _this.alpha+')';
										ctx.fill();
									};
								}
								initHeader();
								addListeners();
							}());
						</script>
					</div>
					<article id="post-gulp" class="article article-type-post" itemscope itemprop="blogPost">
	<div class="article-meta">
		
	</div>
	<div class="article-inner">
		
		
			<header class="article-header">
				
	
		<h1 class="article-title" itemprop="name">
			Gulp 快速入门
		</h1>
	


				<a href="/2017/01/03/gulp/" class="article-date">
  <time datetime="2017-01-03T05:25:41.000Z" itemprop="datePublished">2017-01-03</time>
</a>
			</header>
		
		<div class="article-entry" itemprop="articleBody">
			
				<p>现今，gulp 在前端工程化开发中的重要程度可见一斑，好多重复繁琐的操作 gulp 都可以帮助完成，不像以前的手动去操作，简直是前端开发人员的福音，之前学习 gulp 时没有整理出清晰的学习笔记，这次特地把之前零零散散的笔记整理一份出来。</p>
<a id="more"></a>
<h3 id="gulp-的作用"><a href="#gulp-的作用" class="headerlink" title="gulp 的作用"></a>gulp 的作用</h3><p>gulp 是可以自动化执行任务的工具。在平时开发的流程里面，一定有一些动作需要手工的重复的去执行，比如:</p>
<ul>
<li>把一个文件拷贝到另外一个位置</li>
</ul>
<ul>
<li>把多个 JS 或者 CSS 文件合并成一个文件,以减少网络请求数</li>
<li>对 JS 文件和 CSS 进行合并压缩,以减少网络流量</li>
<li>把 Sass 或者 Less 文件编译成 CSS</li>
<li>压缩图像文件,以减少网络流量</li>
<li>创建一个可以实时刷新页面内容的本地服务器等等。</li>
</ul>
<p>只要你觉得有些动作是要重复去做的，一般你就可以把这些动作创建成一个gulp任务，然后在指定的条件下,比如文件发生变化以后,自动去执行这些任务。</p>
<h3 id="gulp-特点"><a href="#gulp-特点" class="headerlink" title="gulp 特点"></a>gulp 特点</h3><ul>
<li>易于使用 通过代码优于配置的策略，Gulp 让简单的任务简单，复杂的任务可管理。</li>
<li>快速构建 利用 node.js 流的威力，你可以快速构建项目并减少频繁的 IO 操作。前一级的输出，直接变成后一级的输入，使得在操作上非常简单</li>
<li>高质量的插件 Gulp 严格的插件指南确保插件如你期望的那样简洁地工作。</li>
<li>易于学习 通过最少的 API，掌握 Gulp 毫不费力，构建工作尽在掌握。</li>
</ul>
<h3 id="gulp-中的流"><a href="#gulp-中的流" class="headerlink" title="gulp 中的流"></a>gulp 中的流</h3><ul>
<li>gulp 正是通过流和代码优于配置的策略来尽量简化任务编写的工作。</li>
<li>类似 jquery 里的链式操作，把各个方法串连起来构建完整的任务。</li>
<li>用 gulp 编写任务也可看作是用 Node.js 编写任务。</li>
<li>当使用流时，gulp 不需要生成大量的中间文件，只将最后的输出写入磁盘，整个过程因此变得非常快。</li>
</ul>
<p>官方文档解释</p>
<ul>
<li>Stream 是 nodejs 各种对象实现的抽象接口。</li>
<li>比如标准输入是一个流，标准输出也是一个流。</li>
<li>所有的 stream 对象都是 EventEmitter 的实例,可以发射事件。</li>
<li><p>流是一种有起点和终点的数据传输手段。</p>
</li>
<li><p>上一个的输出，是下一个的输入</p>
</li>
<li>上一个的输出，是下一个的输入</li>
<li>上一个的输出，是下一个的输入</li>
</ul>
<h3 id="安装-node"><a href="#安装-node" class="headerlink" title="安装 node"></a>安装 node</h3><p>gulp是基于 Nodejs 的自动任务运行器<br>安装Gulp和相关行件用的都是node的包管理工具 npm<br>所以你需要先在电脑上安装 node,确定在命令行工具的下面可以使用 npm 这个命令，这样就能去安装 Gulp 了。(node.js官网)[<a href="https://nodejs.org/zh-cn/]安装好以后，我们可以打开命令行工具，mac" target="_blank" rel="external">https://nodejs.org/zh-cn/]安装好以后，我们可以打开命令行工具，mac</a> 用户可以使用终端工具(我用的是 mac，Mac开发很很友好，下面都是以mac为例)，windows 用户可以找到cmd命令行工具。</p>
<h3 id="安装gulp"><a href="#安装gulp" class="headerlink" title="安装gulp"></a>安装gulp</h3><p>在项目里使用gulp需要</p>
<ul>
<li>在全局范围内去安装一下gulp的命令行工具</li>
<li>然后在项目里面再去本地安装gulp</li>
</ul>
<h3 id="gulp-命令行工具"><a href="#gulp-命令行工具" class="headerlink" title="gulp 命令行工具"></a>gulp 命令行工具</h3><ul>
<li>使用 npm install 去安装 gulp，注意加上一个 -g 的参数，表示在全局范围内去安装.</li>
<li>一般用 npm 安装的时候用一个 -g 的参数就表示，这个安装的东西会作为命令去执行。</li>
<li>如果你在mac或linux下遇到了权限问题,在下面这个命令的前面加上 sudo npm install gulp -g 并输入mac密码。</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install -g gulp</div></pre></td></tr></table></figure>
<p>安装完成后可以输入</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gulp --help</div></pre></td></tr></table></figure>
<p>如果输出一些帮助的信息就表示可以 gulp 命令行成功安装了</p>
<h4 id="1-先创建一个目录"><a href="#1-先创建一个目录" class="headerlink" title="1. 先创建一个目录"></a>1. 先创建一个目录</h4><p>在 mac 和 linux 操作系统下执行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mkdir learngulp</div></pre></td></tr></table></figure>
<p>在 windows 操作系统下执行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">md learngulp</div></pre></td></tr></table></figure>
<h4 id="2-使用-命令进入此目录"><a href="#2-使用-命令进入此目录" class="headerlink" title="2. 使用 命令进入此目录"></a>2. 使用 命令进入此目录</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">cd</span> learngulp</div></pre></td></tr></table></figure>
<h4 id="3-创建项目描述文件-package-json"><a href="#3-创建项目描述文件-package-json" class="headerlink" title="3. 创建项目描述文件 package.json"></a>3. 创建项目描述文件 package.json</h4><p>npm，需要一个叫 package.json 的文件来管理依赖，可以手工去创建这个文件，也可以使用 npm init 这个命令。 输入</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm init</div></pre></td></tr></table></figure>
<p>输入一些问题答案</p>
<p>name: (zhufeng_automation) learngulp  //项目名字，npm init会自动取当前目录名作为默认名字，这里不需要改，直接确认即可<br>version: (1.0.0) 1.0.0    //项目版本号<br>description: learn gulp   //项目说明<br>entry point: (index.js) index.js  //入门文件 npm start 会执行此文件<br>test command: test.js  //测试脚本 npm test 会执行此文件<br>git repository: (<a href="https://github/zhufengpeixun/zhufeng_automation.git" target="_blank" rel="external">https://github/zhufengpeixun/zhufeng_automation.git</a>) //模块的git仓库，选填。npm的用户一般都使用github做为自己的git仓库<br>keywords: node.js gulp  //在npmjs官网搜索时的关键字<br>author: bevis //项目作者名字<br>license: (ISC) MIT //授权协议</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">"name"</span>: <span class="string">"learngulp"</span>,</div><div class="line">  <span class="attr">"version"</span>: <span class="string">"1.0.0"</span>,</div><div class="line">  <span class="attr">"description"</span>: <span class="string">"learn gulp"</span>,</div><div class="line">  <span class="attr">"main"</span>: <span class="string">"index.js"</span>,</div><div class="line">  <span class="attr">"dependencies"</span>: &#123;</div><div class="line">    <span class="attr">"gulp"</span>: <span class="string">"^3.9.0"</span></div><div class="line">  &#125;,</div><div class="line">  <span class="attr">"devDependencies"</span>: &#123;&#125;,</div><div class="line">  <span class="attr">"scripts"</span>: &#123;</div><div class="line">    <span class="attr">"test"</span>: <span class="string">"test.js"</span></div><div class="line">  &#125;,</div><div class="line">  <span class="attr">"repository"</span>: &#123;</div><div class="line">    <span class="attr">"type"</span>: <span class="string">"git"</span>,</div><div class="line">    <span class="attr">"url"</span>: <span class="string">"https://xxx.xxxx.git"</span></div><div class="line">  &#125;,</div><div class="line">  <span class="attr">"keywords"</span>: [</div><div class="line">    <span class="string">"node.js"</span>,</div><div class="line">    <span class="string">"gulp"</span></div><div class="line">  ],</div><div class="line">  <span class="attr">"author"</span>: <span class="string">"bevis"</span>,</div><div class="line">  <span class="attr">"license"</span>: <span class="string">"MIT"</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Is this ok? (yes) yes //对以上内容确认无误后，就可以直接回车确认了</p>
<p>回车后会在当前目录下创建一个 package.json 文件</p>
<p>这样可以把 gulp 作为项目的开发依赖(只在开发时用，不会发布到线上)，通过</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install gulp --save-dev</div></pre></td></tr></table></figure>
<p>在node_modules下安装本地的gulp库并把添加配置到 package.json 文件里面。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">"devDependencies": &#123;</div><div class="line">  "gulp": "^3.9.0"</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="1-创建配置文件："><a href="#1-创建配置文件：" class="headerlink" title="1.创建配置文件："></a>1.创建配置文件：</h4><p>gulp 的任务要放到一个叫 gulpfile.js 的文件里面，先在项目的根目录下面创建一个这样的文件。 然后在这个文件的顶部添加下面这行代码：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">'gulp'</span>);</div></pre></td></tr></table></figure>
<p>通过require可以把gulp模块引入当前项目并赋值给gulp变量<br>这样，gulp 这个变量里面就会拥有 gulp 的所有的方法了</p>
<h4 id="2-创建gulp的任务"><a href="#2-创建gulp的任务" class="headerlink" title="2.创建gulp的任务"></a>2.创建gulp的任务</h4><p>可以使用gulp的task方法<br>同样我们去创建一个叫 hello 的任务，它要做的事就是在控制台上输出 “您好” 这两个字<br>第一个参数是任务的名称，第二个参数是任务的定义,是一个匿名函数</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">gulp.task(<span class="string">'hello'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'您好'</span>);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>执行 Gulp 的任务，打开命令行工具，进入到项目所在的目录，然后输入：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gulp hello</div></pre></td></tr></table></figure>
<p>会返回：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$ gulp hello</div><div class="line">[21:36:34] Using gulpfile \\xxx\\gulpfile.js</div><div class="line">[21:36:34] Starting <span class="string">'hello'</span>...</div><div class="line">您好</div><div class="line">[21:36:34] Finished <span class="string">'hello'</span> after 959 μs</div></pre></td></tr></table></figure>
<p>gulp后面跟着的是任务的名称，不输入任务名称的话会默认找default任务，找不到会报错</p>
<h3 id="执行其它任务"><a href="#执行其它任务" class="headerlink" title="执行其它任务"></a>执行其它任务</h3><p>可以使用</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gulp &lt;task&gt; &lt;othertask&gt;</div></pre></td></tr></table></figure>
<p>gulp 只有你需要熟知的参数标记，其他所有的参数标记只在一些任务需要的时候使用。</p>
<ul>
<li>-v 或 –version 会显示全局和项目本地所安装的 gulp 版本号</li>
<li>–gulpfile 手动指定一个 gulpfile 的路径，这在你有很多个 gulpfile 的时候很有用。这也会将 CWD 设置到该 gulpfile 所在目录</li>
<li>–cwd dirpath 手动指定 CWD。定义 gulpfile 查找的位置，此外，所有的相应的依赖（require）会从这里开始计算相对路径</li>
<li>-T 或 –tasks 会显示所指定 gulpfile 的 task 依赖树</li>
<li>–tasks-simple 会以纯文本的方式显示所载入的 gulpfile 中的 task 列表</li>
<li>–color 强制 gulp 和 gulp 插件显示颜色，即便没有颜色支持</li>
<li>–no-color 强制不显示颜色，即便检测到有颜色支持</li>
<li>–silent 禁止所有的 gulp 日志</li>
</ul>
<h3 id="gulp-js工作方式"><a href="#gulp-js工作方式" class="headerlink" title="gulp.js工作方式"></a>gulp.js工作方式</h3><p>gulp的使用流程一般是：首先通过gulp.src()方法获取到想要处理的文件流，<br>然后把文件流通过pipe方法导入到gulp的插件中，<br>最后把经过插件处理后的流再通过pipe方法导入到gulp.dest()中，<br>gulp.dest()方法则把流中的内容写入到文件中。例如：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">'gulp'</span>);</div><div class="line">gulp.src(<span class="string">'script/src.js'</span>)            <span class="comment">// 获取文件的流的api</span></div><div class="line">  .pipe(gulp.dest(<span class="string">'dist/dest.js'</span>));  <span class="comment">// 写文件的api</span></div></pre></td></tr></table></figure>
<p>使用gulp，仅需知道4个API即可：gulp.task(),gulp.src(),gulp.dest(),gulp.watch()，所以很容易就能掌握</p>
<h3 id="gulp-src"><a href="#gulp-src" class="headerlink" title="gulp.src()"></a>gulp.src()</h3><p>在Gulp中，使用的是Nodejs中的stream(流)，首先获取到需要的stream，然后可以通过stream的pipe()方法把流导入到你想要的地方，比如Gulp的插件中，经过插件处理后的流又可以继续导入到其他插件中，当然也可以把流写入到文件中。所以Gulp是以stream为媒介的，它不需要频繁的生成临时文件，这也是Gulp的速度比Grunt快的一个原因。再回到正题上来，gulp.src()方法正是用来获取流的，但要注意这个流里的内容不是原始的文件流，而是一个虚拟文件对象流(Vinyl files)，这个虚拟文件对象中存储着原始文件的路径、文件名、内容等信息，这个我们暂时不用去深入理解，你只需简单的理解可以用这个方法来读取你需要操作的文件就行了。其语法为：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gulp.src(globs[, options])</div></pre></td></tr></table></figure>
<p>globs参数是文件匹配模式(类似正则表达式)，用来匹配文件路径(包括文件名)，当然这里也可以直接指定某个具体的文件路径。当有多个匹配模式时，该参数可以为一个数组。<br>options为可选参数。通常情况下我们不需要用到</p>
<h3 id="glob语法"><a href="#glob语法" class="headerlink" title="glob语法"></a>glob语法</h3><p>gulp内部使用了node-glob模块来实现其文件匹配功能。我们可以使用下面这些特殊的字符来匹配我们想要的文件：</p>
<p><img src="/images/gulp/1.png" alt=""></p>
<p>下面以例子来加深理解</p>
<p>glob匹配</p>
<p><img src="/images/gulp/2.png" alt=""></p>
<h3 id="gulp-dest"><a href="#gulp-dest" class="headerlink" title="gulp.dest()"></a>gulp.dest()</h3><p>gulp.dest()方法是用来写文件的，其语法为：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gulp.dest(path[,options])</div></pre></td></tr></table></figure>
<p>path: 为写入文件的路径<br>options: 为一个可选的参数对象，通常我们不需要用到</p>
<p>要想使用好gulp.dest()这个方法，就要理解给它传入的路径参数与最终生成的文件的关系。</p>
<p>gulp的使用流程一般是这样子的：首先通过gulp.src()方法获取到我们想要处理的文件流，<br>然后把文件流通过pipe方法导入到gulp的插件中，最后把经过插件处理后的流再通过pipe方法导入到gulp.dest()中，<br>gulp.dest()方法则把流中的内容写入到文件中，<br>这里首先需要弄清楚的一点是，我们给gulp.dest()传入的路径参数，只能用来指定要生成的文件的目录，<br>而不能指定生成文件的文件名，它生成文件的文件名使用的是导入到它的文件流自身的文件名，<br>所以生成的文件名是由导入到它的文件流决定的，即使我们给它传入一个带有文件名的路径参数，<br>然后它也会把这个文件名当做是目录名，例如：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">'gulp'</span>);</div><div class="line">gulp.src(<span class="string">'script/jquery.js'</span>)</div><div class="line">.pipe(gulp.dest(<span class="string">'dist/foo.js'</span>));</div><div class="line"><span class="comment">//最终生成的文件路径为 dist/foo.js/jquery.js,而不是dist/foo.js</span></div></pre></td></tr></table></figure>
<p>要想改变文件名，可以使用插件 gulp-rename</p>
<p>下面说说生成的文件路径与我们给gulp.dest()方法传入的路径参数之间的关系。<br>gulp.dest(path)生成的文件路径是我们传入的path参数后面再加上gulp.src()中有通配符开始出现的那部分路径。例如：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> gulp = reruire(<span class="string">'gulp'</span>);</div><div class="line"></div><div class="line">gulp.src(<span class="string">'script/**/*.js'</span>)  <span class="comment">//有通配符开始出现的那部分路径为 `-*/*.js`</span></div><div class="line">.pipe(gulp.dest(<span class="string">'dist'</span>));   <span class="comment">//最后生成的文件路径为 dist/**/*.js</span></div><div class="line"><span class="comment">//如果 **/*.js 匹配到的文件为 jquery/jquery.js ,则生成的文件路径为 dist/jquery/jquery.js</span></div></pre></td></tr></table></figure>
<p>再举更多一点的例子</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">gulp.src(<span class="string">'script/avalon/avalon.js'</span>) <span class="comment">//没有通配符出现的情况</span></div><div class="line">.pipe(gulp.dest(<span class="string">'dist'</span>)); <span class="comment">//最后生成的文件路径为 dist/avalon.js</span></div><div class="line"></div><div class="line"><span class="comment">//有通配符开始出现的那部分路径为 **/underscore.js</span></div><div class="line">gulp.src(<span class="string">'script/**/underscore.js'</span>)</div><div class="line"><span class="comment">//假设匹配到的文件为script/util/underscore.js</span></div><div class="line">.pipe(gulp.dest(<span class="string">'dist'</span>)); <span class="comment">//则最后生成的文件路径为 dist/util/underscore.js</span></div><div class="line"></div><div class="line">gulp.src(<span class="string">'script/*'</span>) <span class="comment">//有通配符出现的那部分路径为 *</span></div><div class="line"><span class="comment">//假设匹配到的文件为script/zepto.js    </span></div><div class="line">.pipe(gulp.dest(<span class="string">'dist'</span>)); <span class="comment">//则最后生成的文件路径为 dist/zepto.js</span></div></pre></td></tr></table></figure>
<p>通过指定gulp.src()方法配置参数中的base属性，我们可以更灵活的来改变gulp.dest()生成的文件路径。<br>当我们没有在gulp.src()方法中配置base属性时，base的默认值为通配符开始出现之前那部分路径，例如：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gulp.src(<span class="string">'app/src/**/*.css'</span>) <span class="comment">//此时base的值为 app/src</span></div></pre></td></tr></table></figure>
<p>上面我们说的gulp.dest()所生成的文件路径的规则，其实也可以理解成，用我们给gulp.dest()传入的路径替换掉gulp.src()中的base路径，最终得到生成文件的路径。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">gulp.src(<span class="string">'app/src/**/*.css'</span>) <span class="comment">//此时base的值为app/src,也就是说它的base路径为app/src</span></div><div class="line"><span class="comment">//设该模式匹配到了文件 app/src/css/normal.css</span></div><div class="line">.pipe(gulp.dest(<span class="string">'dist'</span>)) <span class="comment">//用dist替换掉base路径，最终得到 dist/css/normal.css</span></div></pre></td></tr></table></figure>
<p>所以改变base路径后，gulp.dest()生成的文件路径也会改变</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">gulp.src(script/lib/\*.js) <span class="comment">//没有配置base参数，此时默认的base路径为script/lib</span></div><div class="line"><span class="comment">//假设匹配到的文件为script/lib/jquery.js</span></div><div class="line">.pipe(gulp.dest(<span class="string">'build'</span>)) <span class="comment">//生成的文件路径为 build/jquery.js</span></div><div class="line"></div><div class="line">gulp.src(script/lib/\*.js, &#123;<span class="attr">base</span>:<span class="string">'script'</span>&#125;) <span class="comment">//配置了base参数，此时base路径为script</span></div><div class="line"><span class="comment">//假设匹配到的文件为script/lib/jquery.js</span></div><div class="line">.pipe(gulp.dest(<span class="string">'build'</span>)) <span class="comment">//此时生成的文件路径为 build/lib/jquery.js, 用gulp.dest()把文件流写入文件后，文件流仍然可以继续使用。</span></div></pre></td></tr></table></figure>
<h3 id="gulp-task"><a href="#gulp-task" class="headerlink" title="gulp.task()"></a>gulp.task()</h3><p>gulp.task方法用来定义任务，其语法为：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gulp.task(name[, deps], fn)</div></pre></td></tr></table></figure>
<p>name: 为任务名<br>deps: 是当前定义的任务需要依赖的其他任务，为一个数组。当前定义的任务会在所有依赖的任务执行完毕后才开始执行。如果没有依赖，则可省略这个参数<br>fn 为任务函数，我们把任务要执行的代码都写在里面。该参数也是可选的。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">gulp.task(<span class="string">'mytask'</span>, [<span class="string">'array'</span>, <span class="string">'of'</span>, <span class="string">'task'</span>, <span class="string">'names'</span>], <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">//定义一个有依赖的任务</span></div><div class="line">  <span class="comment">// Do something</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>gulp.task()这个API没什么好讲的，但需要知道执行多个任务时怎么来控制任务执行的顺序。<br>gulp中执行多个任务，可以通过任务依赖来实现。例如我想要执行one,two,three这三个任务，那我们就可以定义一个空的任务，然后把那三个任务当做这个空的任务的依赖就行了：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//只要执行default任务，就相当于把one,two,three这三个任务执行了</span></div><div class="line">gulp.task(<span class="string">'default'</span>,[<span class="string">'one'</span>,<span class="string">'two'</span>,<span class="string">'three'</span>]);</div></pre></td></tr></table></figure>
<p>如果任务相互之间没有依赖，任务会按你书写的顺序来执行，如果有依赖的话则会先执行依赖的任务。<br>但是如果某个任务所依赖的任务是异步的，就要注意了，gulp并不会等待那个所依赖的异步任务完成，而是会接着执行后续的任务。例如：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">gulp.task(<span class="string">'one'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="comment">//one是一个异步执行的任务</span></div><div class="line">  setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'one is done'</span>)</div><div class="line">  &#125;,<span class="number">5000</span>);</div><div class="line">&#125;);</div><div class="line"><span class="comment">//two任务虽然依赖于one任务,但并不会等到one任务中的异步操作完成后再执行</span></div><div class="line"></div><div class="line">gulp.task(<span class="string">'two'</span>,[<span class="string">'one'</span>],<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'two is done'</span>);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>上面的例子中我们执行two任务时，会先执行one任务，但不会去等待one任务中的异步操作完成后再执行two任务，而是紧接着执行two任务。所以two任务会在one任务中的异步操作完成之前就执行了。</p>
<p>那如果我们想等待异步任务中的异步操作完成后再执行后续的任务，该怎么做呢？<br>有三种方法可以实现：</p>
<p>第一：在异步操作完成后执行一个回调函数来通知gulp这个异步任务已经完成,这个回调函数就是任务函数的第一个参数。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">gulp.task(<span class="string">'one'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">cb</span>)</span>&#123; <span class="comment">//cb为任务函数提供的回调，用来通知任务已经完成</span></div><div class="line">  <span class="comment">//one是一个异步执行的任务</span></div><div class="line">  setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'one is done'</span>);</div><div class="line">    cb();  <span class="comment">//执行回调，表示这个异步任务已经完成</span></div><div class="line">  &#125;,<span class="number">5000</span>);</div><div class="line">&#125;);</div><div class="line"><span class="comment">//这时two任务会在one任务中的异步操作完成后再执行</span></div><div class="line"></div><div class="line">gulp.task(<span class="string">'two'</span>,[<span class="string">'one'</span>],<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'two is done'</span>);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>第二：定义任务时返回一个流对象。适用于任务就是操作gulp.src获取到的流的情况。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">gulp.task(<span class="string">'one'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">cb</span>)</span>&#123;</div><div class="line">  <span class="keyword">var</span> stream = gulp.src(<span class="string">'client/**/*.js'</span>)</div><div class="line">    .pipe(dosomething()) <span class="comment">//dosomething()中有某些异步操作</span></div><div class="line">    .pipe(gulp.dest(<span class="string">'build'</span>));</div><div class="line">  <span class="keyword">return</span> stream;</div><div class="line">&#125;);</div><div class="line"></div><div class="line">gulp.task(<span class="string">'two'</span>,[<span class="string">'one'</span>],<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'two is done'</span>);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>第三：返回一个promise对象，例如</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> Q = <span class="built_in">require</span>(<span class="string">'q'</span>); <span class="comment">//一个著名的异步处理的库 https://github.com/kriskowal/q</span></div><div class="line">gulp.task(<span class="string">'one'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">cb</span>)</span>&#123;</div><div class="line">  <span class="keyword">var</span> deferred = Q.defer();</div><div class="line">  <span class="comment">// 做一些异步操作</span></div><div class="line">  setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    deferred.resolve();</div><div class="line">  &#125;, <span class="number">5000</span>);</div><div class="line">  <span class="keyword">return</span> deferred.promise;</div><div class="line">&#125;);</div><div class="line"></div><div class="line">gulp.task(<span class="string">'two'</span>,[<span class="string">'one'</span>],<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'two is done'</span>);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>gulp.task()就这些了，主要是要知道当依赖是异步任务时的处理。</p>
<h3 id="gulp-watch"><a href="#gulp-watch" class="headerlink" title="gulp.watch()"></a>gulp.watch()</h3><p>gulp.watch()用来监视文件的变化，当文件发生变化后，我们可以利用它来执行相应的任务，例如文件压缩等。其语法为</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gulp.watch(glob[, opts], tasks)</div></pre></td></tr></table></figure>
<p>glob 为要监视的文件匹配模式，规则和用法与gulp.src()方法中的 glob 相同。<br>opts 为一个可选的配置对象，通常不需要用到<br>tasks 为文件变化后要执行的任务，为一个数组</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">gulp.task(<span class="string">'uglify'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="comment">//do something</span></div><div class="line">&#125;);</div><div class="line">gulp.task(<span class="string">'reload'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="comment">//do something</span></div><div class="line">&#125;);</div><div class="line">gulp.watch(<span class="string">'js/**/*.js'</span>, [<span class="string">'uglify'</span>,<span class="string">'reload'</span>]);</div></pre></td></tr></table></figure>
<p>gulp.watch()还有另外一种使用方式：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gulp.watch(glob[, opts, cb])</div></pre></td></tr></table></figure>
<p>glob和 opts 参数与第一种用法相同<br>cb参数为一个函数。每当监视的文件发生变化时，就会调用这个函数,并且会给它传入一个对象，该对象包含了文件变化的一些信息，type属性为变化的类型，可以是 added , changed , deleted ； path 属性为发生变化的文件的路径</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">gulp.watch(<span class="string">'js/**/*.js'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">event</span>)</span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(event.type); <span class="comment">//变化类型 added为新增,deleted为删除，changed为改变</span></div><div class="line">  <span class="built_in">console</span>.log(event.path); <span class="comment">//变化的文件的路径</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h4 id="1-导入gulp"><a href="#1-导入gulp" class="headerlink" title="1. 导入gulp"></a>1. 导入gulp</h4><p>打开 gulpfile.js ，在这里先去创建一个对象，叫 gulp ，让它等于 require(‘gulp’);<br>这样这个 gulp 对象就拥有了 gulp 提供的所有属性还有方法了。</p>
<h4 id="2-创建源文件"><a href="#2-创建源文件" class="headerlink" title="2. 创建源文件"></a>2. 创建源文件</h4><p>在app下创建</p>
<p><img src="/images/gulp/3.png" alt=""></p>
<h4 id="3-任务目标"><a href="#3-任务目标" class="headerlink" title="3. 任务目标"></a>3. 任务目标</h4><p>然后用gulp的task方法,去创建一个任务，把imgs目录里的文件复制到dist这个目录的下面</p>
<h4 id="4-编写任务"><a href="#4-编写任务" class="headerlink" title="4. 编写任务"></a>4. 编写任务</h4><ul>
<li>先给这个任务起个名字 … 可以叫它 copy-html</li>
<li>再写一个匿名函数</li>
<li>先用写 return</li>
<li>大部分的 gulp 任务，首先要做的就是去读取要处理的文件,读取文件用的是 src 这个方法 ‘app/imgs/*.png’ 指app/imgs/这个目录里面的所有的.png格式的图片,这个 <em> 号表示的就是任何东西. \</em>.png 意思就是，不管图片的文件名是什么，只要它是 .png 格式的就行</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gulp.src(<span class="string">'app/imgs/*.png'</span>)</div></pre></td></tr></table></figure>
<h4 id="5-执行"><a href="#5-执行" class="headerlink" title="5. 执行"></a>5. 执行</h4><p>打开命令行工具<br>先确定当前的位置是在项目的目录里面<br>然后输入 gulp+后面加上任务的名字</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gulp copy-html</div></pre></td></tr></table></figure>
<p>输入回车，会出现一些提示：</p>
<ul>
<li>使用的 gulpfile 的位置</li>
<li>开始执行的任务</li>
<li>还有任务结束所花的时间</li>
</ul>
<p>完成以后，你会看到，在项目的dist这个目录里面，会创建一个叫imgs的目录,在这个目录里面，有两张图片1.png 2.png它们都是从项目根目录下的imgs这个目录里面复制过来的.<br>在这个目录里面，这张jpg格式的图片，还有small里面的图片，并没有复制到dist下面的 imgs 目录里面。因为我们写的glob只匹配imgs目录下的所有的.png格式的图片</p>
<h4 id="6-指定多个后缀"><a href="#6-指定多个后缀" class="headerlink" title="6.指定多个后缀"></a>6.指定多个后缀</h4><p>如果你想把 imgs 目录下面的所有的图像文件都复制到 dist 下面的 imgs 目录里面，在这个 src 方法的 glob 里面，可以指定多个扩展名,现在是 *.png, 后面加上一组花括号,在这个花括号里面，指定多个扩展名.{jpg,png}注意逗号的后面不要使用空格.</p>
<h4 id="多个-glob"><a href="#多个-glob" class="headerlink" title="多个 glob"></a>多个 glob</h4><p>有些任务你可能需要用到多个glob，这样我们就可以用一个数组，数组里的每个项目表示的就是用来匹配文件的glob。<br>比如我们的项目里有两个目录，css还有js。<br>每个目录下面都有一些文件。<br>我们想创建一个任务，需要用到这两个目录里面的东西。<br>在这个任务里，我们就可以使用多个glob。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[<span class="string">'app/css/*.css'</span>,<span class="string">'app/js/*.js'</span>]</div></pre></td></tr></table></figure>
<p>数组里有两个glob<br>再次执行任务<br>会发现glob中的文件都拷贝到dist下面去了</p>
<h4 id="排除特定文件"><a href="#排除特定文件" class="headerlink" title="排除特定文件"></a>排除特定文件</h4><p>在 glob 的前面，再加上一个!号，表示这是要排除掉的文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[<span class="string">'app/css/*.css'</span>,<span class="string">'app/js/*.js'</span>,<span class="string">'!app/js/*.tmp.js'</span>]</div></pre></td></tr></table></figure>
<p>代码</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">'gulp'</span>);</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * 复制图片</div><div class="line"> */</div><div class="line">gulp.task(<span class="string">'copy-images'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> gulp.src(<span class="string">'app/imgs/*.jpg'</span>).pipe(gulp.dest(<span class="string">'dist'</span>));</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * 1. &#123;&#125; 里可以指定多个扩展名</div><div class="line"> * 2. * 匹配所有的字符，除了路径分隔符 /</div><div class="line"> * 3. ** 匹配所有的字符，包括路径分隔符 /</div><div class="line"> */</div><div class="line">gulp.task(<span class="string">'copy-images'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> gulp.src(<span class="string">'app/imgs/**/*.&#123;jpg,png&#125;'</span>).pipe(gulp.dest(<span class="string">'dist'</span>));</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * 匹配多个目录 glob</div><div class="line"> * 可以填写一个数组</div><div class="line"> *</div><div class="line"> */</div><div class="line">gulp.task(<span class="string">'copy-other'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> gulp.src([<span class="string">'app/css/*.css'</span>,<span class="string">'app/js/*.js'</span>],&#123;<span class="attr">base</span>:<span class="string">'app'</span>&#125;).pipe(gulp.dest(<span class="string">'dist'</span>));</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * 匹配多个目录 glob</div><div class="line"> * ! 排除一个文件</div><div class="line"> *</div><div class="line"> */</div><div class="line">gulp.task(<span class="string">'copy-other'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> gulp.src([<span class="string">'app/css/*.css'</span>,<span class="string">'app/js/*.js'</span>,<span class="string">'!app/js/*.tmp.js'</span>],&#123;<span class="attr">base</span>:<span class="string">'app'</span>&#125;).pipe(gulp.dest(<span class="string">'dist'</span>));</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h4 id="1-组合任务"><a href="#1-组合任务" class="headerlink" title="1. 组合任务"></a>1. 组合任务</h4><p>在创建 gulp 任务的时候，我们可以去给任务指定它依赖的其它的任务。<br>比如，这里我们创建了三个任务，copy-html，copy-imgs，copy-other。<br>我们想再创建一个叫 build 的任务，这个任务依赖这里的这三个任务。</p>
<h4 id="2-编写"><a href="#2-编写" class="headerlink" title="2. 编写"></a>2. 编写</h4><p>使用gulp的task这个方法去创建任务<br>先给这个任务起个名字,叫做 build.<br>再把这个方法的第二个参数设置成一个数组,这个数组里的项目就是这个任务所依赖的任务,输入一组方括号,再把它需要的三个任务，作为这个数组的三个项目.<br>我们可以继续去设计这个任务要作的事情，用一个匿名函数,<br>可以让它在控制台上输出 编译成功 ,这样在执行 build 任务的时候，会先去执行它依赖的三个任务，最后再执行它本身要做的任务。</p>
<h4 id="3-执行"><a href="#3-执行" class="headerlink" title="3. 执行"></a>3. 执行</h4><p>保存,打开命令行工具,输入 gulp build,回车.<br>注意这里会同时去执行 build 需要的三个任务，并不是先执行一个，等待完成以后再去执行一个，<br>这些依赖的任务是同时执行的,等它们都完成以后，才会执行 build 本身要做的任务，这里就是在控制台上，输出编译成功 这几个字儿。</p>
<p>代码</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">'gulp'</span>);</div><div class="line"></div><div class="line">gulp.task(<span class="string">'copy-html'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> gulp.src(<span class="string">'app/index.html'</span>).pipe(gulp.dest(<span class="string">'dist'</span>));</div><div class="line">&#125;);</div><div class="line"></div><div class="line">gulp.task(<span class="string">'copy-images'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> gulp.src(<span class="string">'app/imgs/**/*.&#123;jpg,png&#125;'</span>).pipe(gulp.dest(<span class="string">'dist'</span>));</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * 匹配多个目录 glob</div><div class="line"> * ! 排除一个文件</div><div class="line"> *</div><div class="line"> */</div><div class="line">gulp.task(<span class="string">'copy-other'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> gulp.src([<span class="string">'app/css/*.css'</span>,<span class="string">'app/js/*.js'</span>,<span class="string">'app/js/*.tmp.js'</span>],&#123;<span class="attr">base</span>:<span class="string">'app'</span>&#125;).pipe(gulp.dest(<span class="string">'dist'</span>));</div><div class="line">&#125;);</div><div class="line"></div><div class="line">gulp.task(<span class="string">'default'</span>,[<span class="string">'copy-html'</span>,<span class="string">'copy-images'</span>,<span class="string">'copy-other'</span>],<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'全部拷贝任务执行完毕!'</span>);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h4 id="1-监听任务"><a href="#1-监听任务" class="headerlink" title="1. 监听任务"></a>1. 监听任务</h4><p>使用 gulp 的 watch 这个方法，我们可以去监视一些文件，当这些文件发生变化的时候，立即去执行一些指定的任务</p>
<h4 id="2-编写-1"><a href="#2-编写-1" class="headerlink" title="2.编写"></a>2.编写</h4><p>先打开 gulpfile.js,再去创建一个任务<br>gulp.task,这个任务可以叫做 watch,再用一个匿名函数,在它里面，再用 gulp 的 watch 方法去做点事情。</p>
<p>输入 gulp.watch(),先指定一下要监视的文件,比如去监视 index.html<br>再把要执行的任务列表放到这里，这个任务列表要放到一个数组里，所以先输入一组方括号，要执行的任务是 copy-html.<br>它的意思就是，我们在执行 watch 任务的时候，去监视 index.html 这个文件的变化，当这个文件发生变化以后，就去自动执行 copy-html 这个任务。</p>
<h3 id="执行"><a href="#执行" class="headerlink" title="执行"></a>执行</h3><p>保存 回到命令行工具<br>先去执行一下刚才创建的 watch 这个任务 gulp watch ,这样 gulp 就会去监视文件的变化了,你会看到这个任务并没有立即结束,它会一直运行,直到我们手工退出这个任务,退出可以按一上 ctrl + C<br>再回到项目,打开 index.html 这个文件,随便修改一个地方,然后保存一下,回到命令行,你会看到 gulp 执行了 copy-html 这个任务，因为 index.html 这个文件发生了变化</p>
<p>每次保存被监视的文件，都会去执行指定的任务列表。<br>回到项目，打开 dist 下面的 index.html,你会看到修改之后的 index.html 已经被复制到了这个目录的下面.</p>
<h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">'gulp'</span>);</div><div class="line"></div><div class="line">gulp.task(<span class="string">'copy-html'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> gulp.src(<span class="string">'app/index.html'</span>).pipe(gulp.dest(<span class="string">'dist'</span>));</div><div class="line">&#125;);</div><div class="line"></div><div class="line">gulp.task(<span class="string">'copy-images'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> gulp.src(<span class="string">'app/imgs/**/*.&#123;jpg,png&#125;'</span>,&#123;<span class="attr">base</span>:<span class="string">'app'</span>&#125;).pipe(gulp.dest(<span class="string">'dist'</span>));</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * 匹配多个目录 glob</div><div class="line"> * ! 排除一个文件</div><div class="line"> *</div><div class="line"> */</div><div class="line">gulp.task(<span class="string">'copy-other'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> gulp.src([<span class="string">'app/css/*.css'</span>,<span class="string">'app/js/*.js'</span>,<span class="string">'app/js/*.tmp.js'</span>],&#123;<span class="attr">base</span>:<span class="string">'app'</span>&#125;).pipe(gulp.dest(<span class="string">'dist'</span>));</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">//在执行watch的时候会监控index.html文件的变化，发生变化后可以执行拷贝html的任务</span></div><div class="line">gulp.task(<span class="string">'default'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  gulp.watch(<span class="string">'app/index.html'</span>,[<span class="string">'copy-html'</span>]);</div><div class="line">  gulp.watch(<span class="string">'app/imgs/**/*.&#123;jpg,png&#125;'</span>,[<span class="string">'copy-images'</span>]);</div><div class="line">  gulp.watch([<span class="string">'app/css/*.css'</span>,<span class="string">'app/js/*.js'</span>,<span class="string">'app/js/*.tmp.js'</span>],[<span class="string">'copy-other'</span>]);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h3 id="gulp-插件"><a href="#gulp-插件" class="headerlink" title="gulp 插件"></a>gulp 插件</h3><p>gulp提供了一些很实用的接口，但本身并不能做太多的事情。<br>可以读取文件、写入文件以及监控文件等一少部分功能。<br>其它实用的功能都是依靠插件来进行扩展的。<br>这些插件可以实现比如</p>
<ul>
<li>编译 Sass：gulp-sass</li>
<li>编译 Less：gulp-less</li>
<li>合并文件：gulp-concat</li>
<li>压缩js 文件：gulp-uglify</li>
<li>重命名js文件：gulp-rename</li>
<li>优化图像大小：gulp-imagemin</li>
<li>压缩css 文件：gulp-minify-css</li>
<li>创建本地服务器：gulp-connect</li>
<li>实时预览 gulp-connect</li>
</ul>
<p>使用插件</p>
<ul>
<li>npm install xxx –save-dev 安装插件</li>
<li>在 gulpfile.js 顶部引入此插件</li>
<li>在创建任务的时候使用此插件</li>
</ul>
<h3 id="自动加载gulp-插件"><a href="#自动加载gulp-插件" class="headerlink" title="自动加载gulp 插件"></a>自动加载gulp 插件</h3><p>gulp-load-plugins这个插件能自动帮你加载package.json文件里的gulp插件。<br>例如假设你的package.json文件里的依赖是这样的:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">"devDependencies": &#123;</div><div class="line">  "gulp": "^3.9.0",</div><div class="line">  "gulp-concat": "^2.6.0",</div><div class="line">  "gulp-connect": "^2.2.0",</div><div class="line">  "gulp-imagemin": "^2.3.0",</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>然后我们可以在 gulpfile.js 中使用 gulp-load-plugins 来帮我们加载插件：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">'gulp'</span>);</div><div class="line"><span class="comment">//加载gulp-load-plugins插件，并马上运行它</span></div><div class="line"><span class="keyword">var</span> $ = <span class="built_in">require</span>(<span class="string">'gulp-load-plugins'</span>)();</div></pre></td></tr></table></figure>
<p>然后我们要使用gulp-rename和gulp-ruby-sass这两个插件的时候，<br>就可以使用$.concat和$.connect来代替了,也就是原始插件名去掉gulp-前缀，之后再转换为驼峰命名。</p>
<h3 id="less"><a href="#less" class="headerlink" title="less"></a>less</h3><p>less插件可以把less文件编译成css, 可以在app/less下面创建文件page.less,然后就可以把此文件编译到dist下面</p>
<h4 id="安装插件"><a href="#安装插件" class="headerlink" title="安装插件"></a>安装插件</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install gulp-less --save-dev</div></pre></td></tr></table></figure>
<p>安装后可以在node-modules里看到此插件<br>也可以在package.json的devDependencies里面看到此插件的配置</p>
<p>代码如下</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">'gulp'</span>);</div><div class="line"><span class="keyword">var</span> less = <span class="built_in">require</span>(<span class="string">'gulp-less'</span>);</div><div class="line"></div><div class="line">gulp.task(<span class="string">'less'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> gulp.src(<span class="string">'app/less/*.less'</span>).pipe(less()).pipe(gulp.dest(<span class="string">'dist/css'</span>));</div><div class="line">&#125;);</div><div class="line"></div><div class="line">gulp.task(<span class="string">'default'</span>,[<span class="string">'less'</span>]);</div></pre></td></tr></table></figure>
<h3 id="sass"><a href="#sass" class="headerlink" title="sass"></a>sass</h3><p>想要使用 Gulp 去把 Sass 编译成 CSS ，我们可以使用 gulp-sass 这个插件。</p>
<h4 id="插件任务"><a href="#插件任务" class="headerlink" title="插件任务"></a>插件任务</h4><p>可以在app/sass下面创建文件base.scss,然后就可以把此文件编译到dist下面</p>
<h4 id="安装插件-1"><a href="#安装插件-1" class="headerlink" title="安装插件"></a>安装插件</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install gulp-sass --save-dev</div></pre></td></tr></table></figure>
<p>安装后可以在node-modules里看到此插件<br>也可以在package.json的devDependencies里面看到此插件的配置 “gulp-sass”: “^2.0.4”</p>
<h4 id="使用插件"><a href="#使用插件" class="headerlink" title="使用插件"></a>使用插件</h4><p>在项目里面，app/sass 这个目录的下面，有一个sass文件，就是这个base.scss</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$blue : #1875e7;　</div><div class="line">div &#123;</div><div class="line">  color : $blue;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>下面，我们可以使用gulp-sass这个插件，把这个目录里面的sass文件编译成css ，<br>再放到 dist 目录下面的 css 这个目录的下面。</p>
<h4 id="代码如下"><a href="#代码如下" class="headerlink" title="代码如下"></a>代码如下</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">'gulp'</span>);</div><div class="line"><span class="keyword">var</span> sass = <span class="built_in">require</span>(<span class="string">'gulp-sass'</span>);</div><div class="line"></div><div class="line">gulp.task(<span class="string">'sass'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> gulp.src(<span class="string">'app/sass/*.scss'</span>).pipe(sass()).pipe(gulp.dest(<span class="string">'dist/css'</span>));</div><div class="line">&#125;);</div><div class="line"></div><div class="line">gulp.task(<span class="string">'default'</span>,[<span class="string">'sass'</span>]);</div></pre></td></tr></table></figure>
<h3 id="gulp-connect"><a href="#gulp-connect" class="headerlink" title="gulp-connect"></a>gulp-connect</h3><p>有些时候我们需要把文件放到本地服务器上去预览，gulp-connect可以帮我们创建一个本地服务器去运行我们的项目</p>
<h4 id="安装插件-2"><a href="#安装插件-2" class="headerlink" title="安装插件"></a>安装插件</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install gulp-connect --save-dev</div></pre></td></tr></table></figure>
<p>加上一个 –save-dev，把这个插件放到开发依赖里面。</p>
<h4 id="创建任务"><a href="#创建任务" class="headerlink" title="创建任务"></a>创建任务</h4><p>打开 gulpfile.js<br>先在文件的顶部这里<br>去包含一下这个 gulp-connect 插件<br>给它起个名字connect …<br>var connect = require(‘gulp-connect’);</p>
<h4 id="代码如下-1"><a href="#代码如下-1" class="headerlink" title="代码如下"></a>代码如下</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">'gulp'</span>);</div><div class="line"><span class="keyword">var</span> connect = <span class="built_in">require</span>(<span class="string">'gulp-connect'</span>);</div><div class="line"></div><div class="line">gulp.task(<span class="string">'server'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  connect.server(&#123;</div><div class="line">    <span class="attr">root</span>:<span class="string">'dist'</span>,<span class="comment">//服务器的根目录</span></div><div class="line">    port:<span class="number">8080</span> <span class="comment">//服务器的地址，没有此配置项默认也是 8080</span></div><div class="line">  &#125;);</div><div class="line">&#125;);</div><div class="line"></div><div class="line">gulp.task(<span class="string">'default'</span>,[<span class="string">'server'</span>]); <span class="comment">//运行此任务的时候会在8080上启动服务器</span></div></pre></td></tr></table></figure>
<h3 id="gulp-connect-1"><a href="#gulp-connect-1" class="headerlink" title="gulp-connect"></a>gulp-connect</h3><p>我们希望当文件变化的时候浏览器可以自动刷新，这样我们就不需要文件修改后手动去刷新浏览器了</p>
<p>代码如下</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">'gulp'</span>);</div><div class="line"><span class="keyword">var</span> connect = <span class="built_in">require</span>(<span class="string">'gulp-connect'</span>);</div><div class="line"></div><div class="line">gulp.task(<span class="string">'copy-html'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  gulp.src(<span class="string">'app/index.html'</span>)<span class="comment">//指定源文件</span></div><div class="line">    .pipe(gulp.dest(<span class="string">'dist'</span>))<span class="comment">//拷贝到dist目录</span></div><div class="line">    .pipe(connect.reload());<span class="comment">//通知浏览器重启</span></div><div class="line">&#125;);</div><div class="line"></div><div class="line">gulp.task(<span class="string">'watch'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  gulp.watch(<span class="string">'app/index.html'</span>,[<span class="string">'copy-html'</span>]);<span class="comment">//当index.html文件变化时执行copy-html任务</span></div><div class="line">&#125;);</div><div class="line"></div><div class="line">gulp.task(<span class="string">'server'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  connect.server(&#123;</div><div class="line">    <span class="attr">root</span>:<span class="string">'dist'</span>,<span class="comment">//服务器的根目录</span></div><div class="line">    port:<span class="number">8080</span>, <span class="comment">//服务器的地址，没有此配置项默认也是 8080</span></div><div class="line">    livereload:<span class="literal">true</span><span class="comment">//启用实时刷新的功能</span></div><div class="line">  &#125;);</div><div class="line">&#125;);</div><div class="line">gulp.task(<span class="string">'default'</span>,[<span class="string">'server'</span>,<span class="string">'watch'</span>]);<span class="comment">//运行此任务的时候会在8080上启动服务器，</span></div></pre></td></tr></table></figure>
<h3 id="gulp-concat"><a href="#gulp-concat" class="headerlink" title="gulp-concat"></a>gulp-concat</h3><p>这个插件可以把几个文件合并到一块</p>
<p>安装<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install gulp-concat --save-dev</div></pre></td></tr></table></figure></p>
<p>代码如下</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">'gulp'</span>);</div><div class="line"><span class="keyword">var</span> concat = <span class="built_in">require</span>(<span class="string">'gulp-concat'</span>);</div><div class="line"></div><div class="line">gulp.task(<span class="string">'concat'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> gulp.src([<span class="string">'app/js/*.js'</span>,<span class="string">'!app/js/*.tmp.js'</span>])<span class="comment">//指定要合并的文件glob</span></div><div class="line">    .pipe(concat(<span class="string">'app.js'</span>))<span class="comment">//进行合并并指定合并后的文件名</span></div><div class="line">    .pipe(gulp.dest(<span class="string">'dist/js'</span>));<span class="comment">//输出到目标路径</span></div><div class="line">&#125;);</div><div class="line"></div><div class="line">gulp.task(<span class="string">'default'</span>,[<span class="string">'concat'</span>]);</div></pre></td></tr></table></figure>
<h3 id="gulp-uglify"><a href="#gulp-uglify" class="headerlink" title="gulp-uglify"></a>gulp-uglify</h3><p>合并后我们可以对JS文件进行合并，最小化处理</p>
<p>安装<br>先打开命令行安装</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install gulp-uglify --save-dev</div></pre></td></tr></table></figure>
<p>代码如下</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">'gulp'</span>);</div><div class="line"><span class="keyword">var</span> concat = <span class="built_in">require</span>(<span class="string">'gulp-concat'</span>);</div><div class="line"><span class="keyword">var</span> uglify = <span class="built_in">require</span>(<span class="string">'gulp-uglify'</span>)</div><div class="line"></div><div class="line">gulp.task(<span class="string">'uglify'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> gulp.src([<span class="string">'app/js/*.js'</span>,<span class="string">'!app/js/*.tmp.js'</span>])</div><div class="line">    .pipe(concat(<span class="string">'app.js'</span>)) <span class="comment">//把多个JS文件合并成一个文件</span></div><div class="line">    .pipe(uglify()) <span class="comment">//对合并后的app.js文件进行压缩</span></div><div class="line">    .pipe(gulp.dest(<span class="string">'dist/js'</span>)); <span class="comment">//输出到目的地</span></div><div class="line">&#125;);</div><div class="line"></div><div class="line">gulp.task(<span class="string">'default'</span>,[<span class="string">'uglify'</span>]);</div></pre></td></tr></table></figure>
<h3 id="html文件压缩"><a href="#html文件压缩" class="headerlink" title="html文件压缩"></a>html文件压缩</h3><p>gulp-minify-html插件用来压缩html文件。</p>
<p>代码如下</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">'gulp'</span>),</div><div class="line">  minifyHtml = <span class="built_in">require</span>(<span class="string">"gulp-minify-html"</span>);</div><div class="line"></div><div class="line">gulp.task(<span class="string">'minify-html'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  gulp.src(<span class="string">'src/*.html'</span>) <span class="comment">// 要压缩的html文件</span></div><div class="line">  .pipe(minifyHtml())    <span class="comment">//压缩</span></div><div class="line">  .pipe(gulp.dest(<span class="string">'dist/html'</span>));<span class="comment">//输出到目的地</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h3 id="gulp-rename"><a href="#gulp-rename" class="headerlink" title="gulp-rename"></a>gulp-rename</h3><p>在把处理好的文件存放到指定的位置之前，我们可以先去重新命名一下它。可以使用gulp-rename这个插件.</p>
<p>安装</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install gulp-rename --save-dev</div></pre></td></tr></table></figure>
<p>代码如下</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">'gulp'</span>);</div><div class="line"><span class="keyword">var</span> concat = <span class="built_in">require</span>(<span class="string">'gulp-concat'</span>);</div><div class="line"><span class="keyword">var</span> uglify = <span class="built_in">require</span>(<span class="string">'gulp-uglify'</span>);</div><div class="line"><span class="keyword">var</span> rename = <span class="built_in">require</span>(<span class="string">'gulp-rename'</span>);</div><div class="line">gulp.task(<span class="string">'uglify'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> gulp.src([<span class="string">'app/js/*.js'</span>,<span class="string">'!app/js/*.tmp.js'</span>])<span class="comment">//指定要处理的文件</span></div><div class="line">    .pipe(concat(<span class="string">'app.js'</span>))<span class="comment">//合并成一个文件</span></div><div class="line">    .pipe(gulp.dest(<span class="string">'dist/js'</span>))<span class="comment">//保存此文件</span></div><div class="line">    .pipe(uglify())<span class="comment">//进行压缩</span></div><div class="line">    .pipe(rename(<span class="string">'app.min.js'</span>))<span class="comment">//对此文件进行重命名</span></div><div class="line">    .pipe(gulp.dest(<span class="string">'dist/js'</span>));<span class="comment">//再输出一次</span></div><div class="line">&#125;);</div><div class="line"></div><div class="line">gulp.task(<span class="string">'default'</span>,[<span class="string">'uglify'</span>]);</div></pre></td></tr></table></figure>
<h3 id="gulp-minify-css"><a href="#gulp-minify-css" class="headerlink" title="gulp-minify-css"></a>gulp-minify-css</h3><p>如果要想压缩css,我们可以使用gulp-minify-css</p>
<p>安装<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install gulp-minify-css --save-dev</div></pre></td></tr></table></figure></p>
<p>代码如下</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">'gulp'</span>);</div><div class="line"><span class="keyword">var</span> less = <span class="built_in">require</span>(<span class="string">'gulp-less'</span>);</div><div class="line"><span class="keyword">var</span> minify = <span class="built_in">require</span>(<span class="string">'gulp-minify-css'</span>);<span class="comment">//在文件的顶部去包含这个插件，起个名字，叫做 minify</span></div><div class="line"><span class="keyword">var</span> rename = <span class="built_in">require</span>(<span class="string">'gulp-rename'</span>);</div><div class="line">gulp.task(<span class="string">'minify'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> gulp.src(<span class="string">'app/less/page.less'</span>)<span class="comment">//指定 less文件</span></div><div class="line">    .pipe(less())<span class="comment">//把less编译成css</span></div><div class="line">    .pipe(gulp.dest(<span class="string">'dist/css'</span>))<span class="comment">//输出到目的地</span></div><div class="line">    .pipe(minify())<span class="comment">//对 css再进行压缩</span></div><div class="line">    .pipe(rename(<span class="string">'page.min.css'</span>))<span class="comment">//重命名</span></div><div class="line">    .pipe(gulp.dest(<span class="string">'dist/css'</span>));<span class="comment">//输出到目的地</span></div><div class="line">&#125;);</div><div class="line"></div><div class="line">gulp.task(<span class="string">'default'</span>,[<span class="string">'less'</span>]);</div></pre></td></tr></table></figure>
<h3 id="gulp-imagemin"><a href="#gulp-imagemin" class="headerlink" title="gulp-imagemin"></a>gulp-imagemin</h3><p>如果要想在保证不改变图像质量的情况下，让图像文件的体积变得更小一点,我们可以使用gulp-imagemin</p>
<p>安装</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install gulp-imagemin --save-dev</div></pre></td></tr></table></figure>
<p>代码如下</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">'gulp'</span>);</div><div class="line"><span class="keyword">var</span> imagemin = <span class="built_in">require</span>(<span class="string">'gulp-imagemin'</span>);</div><div class="line"></div><div class="line">gulp.task(<span class="string">'copy-images'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> gulp.src(<span class="string">'app/imgs/**/*.&#123;jpg,png&#125;'</span>)<span class="comment">//指定要压缩的图片</span></div><div class="line">    .pipe(imagemin()) <span class="comment">//进行图片压缩</span></div><div class="line">    .pipe(gulp.dest(<span class="string">'dist'</span>));<span class="comment">//输出目的地</span></div><div class="line">&#125;);</div><div class="line"></div><div class="line">gulp.task(<span class="string">'default'</span>,[<span class="string">'copy-images'</span>]);</div></pre></td></tr></table></figure>
<h3 id="jshint"><a href="#jshint" class="headerlink" title="jshint"></a>jshint</h3><p>可以用此插件进行代码检查</p>
<h4 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install gulp-jshint --save-dev</div></pre></td></tr></table></figure>
<h4 id="代码-1"><a href="#代码-1" class="headerlink" title="代码"></a>代码</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">'gulp'</span>),</div><div class="line">  jshint = <span class="built_in">require</span>(<span class="string">"gulp-jshint"</span>);</div><div class="line"></div><div class="line">gulp.task(<span class="string">'jsLint'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  gulp.src(<span class="string">'src/*.js'</span>)</div><div class="line">  .pipe(jshint()) <span class="comment">//进行代码检查</span></div><div class="line">  .pipe(jshint.reporter()); <span class="comment">// 输出检查结果</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>DEMO :</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">"name"</span>: <span class="string">"tongbanke"</span>,</div><div class="line">  <span class="attr">"version"</span>: <span class="string">"1.0.0"</span>,</div><div class="line">  <span class="attr">"description"</span>: <span class="string">"tobanke'"</span>,</div><div class="line">  <span class="attr">"main"</span>: <span class="string">"main.js"</span>,</div><div class="line">  <span class="attr">"scripts"</span>: &#123;</div><div class="line">    <span class="attr">"test"</span>: <span class="string">"test"</span></div><div class="line">  &#125;,</div><div class="line">  <span class="attr">"repository"</span>: &#123;</div><div class="line">    <span class="attr">"type"</span>: <span class="string">"git"</span>,</div><div class="line">    <span class="attr">"url"</span>: <span class="string">"gulp"</span></div><div class="line">  &#125;,</div><div class="line">  <span class="attr">"keywords"</span>: [</div><div class="line">    <span class="string">"gulp"</span>,</div><div class="line">    <span class="string">"test"</span></div><div class="line">  ],</div><div class="line">  <span class="attr">"author"</span>: <span class="string">"kongzhi"</span>,</div><div class="line">  <span class="attr">"license"</span>: <span class="string">"ISC"</span>,</div><div class="line">  <span class="attr">"devDependencies"</span>: &#123;</div><div class="line">    <span class="attr">"gulp"</span>: <span class="string">"^3.6.2"</span>,</div><div class="line">    <span class="attr">"gulp-coffee"</span>: <span class="string">"^1.4.2"</span>,</div><div class="line">    <span class="attr">"gulp-concat"</span>: <span class="string">"^2.6.0"</span>,</div><div class="line">    <span class="attr">"gulp-connect"</span>: <span class="string">"^2.3.1"</span>,</div><div class="line">    <span class="attr">"gulp-jshint"</span>: <span class="string">"^2.0.4"</span>,</div><div class="line">    <span class="attr">"gulp-less"</span>: <span class="string">"^3.1.0"</span>,</div><div class="line">    <span class="attr">"gulp-obfuscate"</span>: <span class="string">"^0.2.9"</span>,</div><div class="line">    <span class="attr">"gulp-uglify"</span>: <span class="string">"^2.0.0"</span>,</div><div class="line">    <span class="attr">"gulp-watch"</span>: <span class="string">"^0.6.2"</span>,</div><div class="line">    <span class="attr">"jshint"</span>: <span class="string">"^2.9.3"</span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">'gulp'</span>);</div><div class="line"><span class="keyword">var</span> concat = <span class="built_in">require</span>(<span class="string">'gulp-concat'</span>); <span class="comment">//文件合并</span></div><div class="line"><span class="keyword">var</span> uglify = <span class="built_in">require</span>(<span class="string">'gulp-uglify'</span>); <span class="comment">//文件压缩</span></div><div class="line"><span class="keyword">var</span> rename = <span class="built_in">require</span>(<span class="string">'gulp-rename'</span>); <span class="comment">//文件重命名</span></div><div class="line"><span class="keyword">var</span> obfuscate = <span class="built_in">require</span>(<span class="string">'gulp-obfuscate'</span>); <span class="comment">//代码混淆</span></div><div class="line"><span class="keyword">var</span> connect = <span class="built_in">require</span>(<span class="string">'gulp-connect'</span>);  <span class="comment">//创建一个本地服务器</span></div><div class="line">jshint = <span class="built_in">require</span>(<span class="string">"gulp-jshint"</span>);   <span class="comment">//语法校验</span></div><div class="line"><span class="comment">// 语法检查</span></div><div class="line"></div><div class="line">gulp.task(<span class="string">'jshint'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'语法检查...'</span>);</div><div class="line">  <span class="keyword">return</span> gulp.src(<span class="string">'src/*.js'</span>)</div><div class="line">    .pipe(jshint())    <span class="comment">//进行代码检查</span></div><div class="line">    .pipe(jshint.reporter(<span class="string">'default'</span>)); <span class="comment">// 输出检查结果</span></div><div class="line">&#125;);</div><div class="line"><span class="comment">//创建一个本地服务器</span></div><div class="line">gulp.task(<span class="string">'server'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">"创建本地服务器！"</span>)</div><div class="line">  connect.server(&#123;</div><div class="line">    <span class="attr">livereload</span>:<span class="literal">true</span>,<span class="comment">//启用实时刷新的功能</span></div><div class="line">    root:<span class="string">'./'</span>,<span class="comment">//服务器的根目录</span></div><div class="line">    port:<span class="number">12306</span> <span class="comment">//服务器的地址，没有此配置项默认也是 8080</span></div><div class="line">  &#125;);</div><div class="line">&#125;);</div><div class="line"><span class="comment">// 合并文件之后压缩代码</span></div><div class="line">gulp.task(<span class="string">'minify'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'压缩合并'</span>);</div><div class="line">  <span class="keyword">return</span> gulp.src(<span class="string">'src/*.js'</span>)  <span class="comment">//指定要合并的文件glob</span></div><div class="line">    .pipe(concat(<span class="string">'main.js'</span>))  <span class="comment">//进行合并并指定合并后的文件名</span></div><div class="line">    .pipe(gulp.dest(<span class="string">'min.js'</span>))  <span class="comment">//输出到目标路径</span></div><div class="line">    .pipe(uglify())</div><div class="line">    .pipe(rename(<span class="string">'main.min.js'</span>))</div><div class="line">    .pipe(connect.reload())  <span class="comment">//通知浏览器重启</span></div><div class="line">    .pipe(gulp.dest(<span class="string">'min.js'</span>));</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">// 监视文件的变化</span></div><div class="line">gulp.task(<span class="string">'watch'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'文件有变动'</span>);</div><div class="line">  gulp.watch(<span class="string">'src/*.js'</span>, [<span class="string">'minify'</span>,<span class="string">'jshint'</span>],<span class="function"><span class="keyword">function</span>(<span class="params">event</span>)</span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(event.type); <span class="comment">//变化类型 added为新增,deleted为删除，changed为改变</span></div><div class="line">    <span class="built_in">console</span>.log(event.path); <span class="comment">//变化的文件的路径</span></div><div class="line">  &#125;);</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">// 注册默认任务</span></div><div class="line">gulp.task(<span class="string">'default'</span>, [<span class="string">'minify'</span>, <span class="string">'watch'</span>,<span class="string">'server'</span>, <span class="string">'jshint'</span>], <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'压缩合并混淆重命名'</span>);</div><div class="line">  <span class="keyword">return</span> gulp.src(<span class="string">'main.min.js'</span>)</div><div class="line">    .pipe(obfuscate()); <span class="comment">//压缩完代码混淆</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure>

				<!-- 多说评论框 start -->
				<div class="article-comment">
					<div class="ds-thread" data-num-items="5" data-show-avatars="1" data-show-time="1" data-show-title="1" data-show-admin="1" data-excerpt-length="50" data-thread-key="post-gulp" data-title="Gulp 快速入门" data-url="/"></div>
				</div>
				<!-- 多说评论框 end -->
			
		</div>
		<footer class="article-footer">
			<a data-url="https://utopia1991.github.io/2017/01/03/gulp/" data-id="ciy0w2ccg0010wbtdsqh3thv1" class="article-share-link">分享</a>
			
			
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Gulp/">Gulp</a></li></ul>

		</footer>
	</div>
	
		
<nav id="article-nav">
  
    <a href="/2017/02/15/jsBug/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">上一篇</strong>
      <div class="article-nav-title">
        
          Javascript 设计缺陷
        
      </div>
    </a>
  
  
    <a href="/2016/12/27/feTired/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">下一篇</strong>
      <div class="article-nav-title">前端疲劳</div>
    </a>
  
</nav>

	
</article>



				</section>
			</div>
			<footer id="footer">
	
	<div class="outer">
		<div id="footer-info">
			Copyright &copy; Bevis Shen 2017<br>
			Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
		</div>
	</div>
</footer>

		</div>
		<nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">主页</a>
  
    <a href="/archives" class="mobile-nav-link">博文</a>
  
</nav>
		

<script src="https://cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

	</div>
</body>
<script>
	function backTop(){
		document.documentElement.scrollTop = document.body.scrollTop = 0;
	}

	var c = document.getElementsByTagName('canvas')[0],
		x = c.getContext('2d'),
		pr = window.devicePixelRatio || 1,
		w = window.innerWidth,
		h = window.innerHeight,
		f = 90,
		q,
		m = Math,
		r = 0,
		u = m.PI * 2,
		v = m.cos,
		z = m.random
	c.width = w * pr
	c.height = h * pr
	x.scale(pr, pr)
	x.globalAlpha = 0.6

	function i() {
		x.clearRect(0, 0, w, h)
		q = [{
			x: 0,
			y: h * .7 + f
		}, {
			x: 0,
			y: h * .7 - f
		}]
		while (q[1].x < w + f) d(q[0], q[1])
	}

	function d(i, j) {
		x.beginPath()
		x.moveTo(i.x, i.y)
		x.lineTo(j.x, j.y)
		var k = j.x + (z() * 2 - 0.25) * f,
			n = y(j.y)
		x.lineTo(k, n)
		x.closePath()
		r -= u / -50
		x.fillStyle = '#' + (v(r) * 127 + 128 << 16 | v(r + u / 3) * 127 + 128 << 8 | v(r + u / 3 * 2) * 127 + 128).toString(16)
		x.fill()
		q[0] = q[1]
		q[1] = {
			x: k,
			y: n
		}
	}

	function y(p) {
		var t = p + (z() * 2 - 1.1) * f
		return (t > h || t < 0) ? y(p) : t
	}
	document.onclick = i
	document.ontouchstart = i
	i()
</script>

<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
<script type="text/javascript">
	var duoshuoQuery = {short_name:"bevis"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0]
		 || document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
</script>
<!-- 多说公共JS代码 end -->
</html>
